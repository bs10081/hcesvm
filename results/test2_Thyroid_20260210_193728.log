================================================================================
Hierarchical CE-SVM - TEST2 Strategy
Dataset: Thyroid
Timestamp: 2026-02-10 19:37:28
================================================================================

Training data:
  Class 1: 14 samples
  Class 2: 29 samples
  Class 3: 533 samples
  Features: 21

================================================================================
Model Parameters
================================================================================
  C_hyper: 1.0
  epsilon: 0.0001
  M: 1000.0
  time_limit: 1800
  mip_gap: 0.0001
  threads: 0
  verbose: True
  enable_selection: True
  feat_upper_bound: 1000
  feat_lower_bound: 1e-07

================================================================================
Training Hierarchical Classifier - TEST2 Strategy
================================================================================

Test2 Strategy:
  H1: {minority, medium} vs majority
  H2: minority vs medium
  Objective function modified based on class roles

============================================================
Training Hierarchical CE-SVM (Strategy: test2)
============================================================
Class 1: 14 samples
Class 2: 29 samples
Class 3: 533 samples
Features: 21

Dynamic Class Roles:
  Majority:  Class 3 (533 samples)
  Medium:    Class 2 (29 samples)
  Minority:  Class 1 (14 samples)

============================================================
Training H1: Class {2, 3} (+1) vs Class 1 (-1)
============================================================
H1 Training samples: 576
  Positive (+1): 562 samples
  Negative (-1): 14 samples
  Accuracy mode: both

Set parameter TimeLimit to value 1800
Set parameter MIPGap to value 0.0001
Set parameter OutputFlag to value 1
Set parameter Threads to value 0
Gurobi Optimizer version 13.0.1 build v13.0.1rc0 (linux64 - "Ubuntu 24.04.3 LTS")

CPU model: AMD Ryzen 9 9900X 12-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 20 physical cores, 20 logical processors, using up to 20 threads

Non-default parameters:
TimeLimit  1800

Optimize a model with 4076 rows, 2370 columns and 16498 nonzeros (Min)
Model fingerprint: 0x8f856d64
Model has 1772 linear objective coefficients
Variable types: 621 continuous, 1749 integer (1749 binary)
Coefficient statistics:
  Matrix range     [1e-07, 1e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+03]

Found heuristic solution: objective 27.0000000
Presolve removed 32 rows and 33 columns
Presolve time: 0.01s
Presolved: 4044 rows, 2337 columns, 16832 nonzeros
Variable types: 33 continuous, 2304 integer (1728 binary)

Root relaxation: objective -1.914000e+00, 661 iterations, 0.01 seconds (0.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   -1.91400    0   42   27.00000   -1.91400   107%     -    0s
     0     0    0.08899    0   51   27.00000    0.08899   100%     -    0s
     0     0    6.08249    0   51   27.00000    6.08249  77.5%     -    0s
     0     0   10.07491    0   72   27.00000   10.07491  62.7%     -    0s
     0     0   10.09492    0   73   27.00000   10.09492  62.6%     -    0s
     0     0   17.19552    0  116   27.00000   17.19552  36.3%     -    0s
     0     0   17.45582    0  120   27.00000   17.45582  35.3%     -    0s
     0     0   17.56747    0  122   27.00000   17.56747  34.9%     -    0s
     0     0   17.60317    0  120   27.00000   17.60317  34.8%     -    0s
     0     0   17.60420    0  119   27.00000   17.60420  34.8%     -    0s
     0     0   18.52445    0  116   27.00000   18.52445  31.4%     -    0s
     0     0   18.66543    0  117   27.00000   18.66543  30.9%     -    0s
     0     0   18.72248    0  109   27.00000   18.72248  30.7%     -    0s
     0     0   18.72775    0  111   27.00000   18.72775  30.6%     -    0s
     0     0   18.74462    0  113   27.00000   18.74462  30.6%     -    0s
     0     0   18.74569    0  111   27.00000   18.74569  30.6%     -    0s
     0     0   18.83435    0  115   27.00000   18.83435  30.2%     -    0s
     0     0   18.87004    0  122   27.00000   18.87004  30.1%     -    0s
     0     0   18.87091    0  122   27.00000   18.87091  30.1%     -    0s
     0     0   21.23209    0  124   27.00000   21.23209  21.4%     -    0s
     0     0   21.82908    0  120   27.00000   21.82908  19.2%     -    0s
     0     0   21.94961    0  118   27.00000   21.94961  18.7%     -    0s
     0     0   21.95060    0  122   27.00000   21.95060  18.7%     -    0s
     0     0   22.12191    0  122   27.00000   22.12191  18.1%     -    0s
     0     0   22.35832    0  113   27.00000   22.35832  17.2%     -    0s
     0     0   22.36940    0  117   27.00000   22.36940  17.2%     -    0s
     0     0   22.40481    0  117   27.00000   22.40481  17.0%     -    0s
     0     0   22.40695    0  114   27.00000   22.40695  17.0%     -    0s
     0     0   22.44114    0  115   27.00000   22.44114  16.9%     -    0s
     0     0   22.48364    0  122   27.00000   22.48364  16.7%     -    0s
     0     0   22.49344    0  120   27.00000   22.49344  16.7%     -    0s
     0     0   22.49519    0  121   27.00000   22.49519  16.7%     -    0s
     0     0   23.18514    0  112   27.00000   23.18514  14.1%     -    0s
     0     0   23.30365    0  116   27.00000   23.30365  13.7%     -    0s
     0     0   23.39154    0  112   27.00000   23.39154  13.4%     -    0s
     0     0   23.39327    0  112   27.00000   23.39327  13.4%     -    0s
     0     0   23.74640    0  105   27.00000   23.74640  12.1%     -    0s
     0     0   23.92585    0  110   27.00000   23.92585  11.4%     -    0s
     0     0   23.96772    0  111   27.00000   23.96772  11.2%     -    0s
     0     0   23.97238    0  104   27.00000   23.97238  11.2%     -    0s
     0     0   23.97473    0  111   27.00000   23.97473  11.2%     -    0s
     0     0   25.26980    0  109   27.00000   25.26980  6.41%     -    0s
     0     0   25.32901    0   97   27.00000   25.32901  6.19%     -    0s
     0     0   25.34272    0  102   27.00000   25.34272  6.14%     -    0s
     0     0   25.35135    0  102   27.00000   25.35135  6.11%     -    0s
     0     0   25.35298    0  100   27.00000   25.35298  6.10%     -    0s
     0     0   25.45538    0   97   27.00000   25.45538  5.72%     -    0s
     0     0   25.45538    0   42   27.00000   25.45538  5.72%     -    0s
     0     0   25.45538    0  105   27.00000   25.45538  5.72%     -    0s
     0     0   25.91891    0   87   27.00000   25.91891  4.00%     -    0s
     0     0   25.98887    0   85   27.00000   25.98887  3.74%     -    0s
     0     0   25.99558    0   91   27.00000   25.99558  3.72%     -    0s
     0     0   26.65923    0   73   27.00000   26.65923  1.26%     -    0s
     0     0   26.66886    0   71   27.00000   26.66886  1.23%     -    0s
     0     0   26.74568    0   67   27.00000   26.74568  0.94%     -    0s
     0     0     cutoff    0        27.00000   27.00000  0.00%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 13
  Clique: 1
  MIR: 34
  Flow cover: 19
  RLT: 2
  Relax-and-lift: 5
  PSD: 2

Explored 1 nodes (4136 simplex iterations) in 0.48 seconds (1.05 work units)
Thread count was 20 (of 20 available processors)

Solution count 2: 27 27 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.700000000000e+01, best bound 2.700000000000e+01, gap 0.0000%

H1 Solution:
  Weights (w): [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  Intercept (b): 1.0
  Objective: 27.000000
  Selected features: 21/21
  L1 norm: 0.000000
  Positive accuracy lb: 1.0000
  Negative accuracy lb: 0.0000

============================================================
Training H2: Class 3 (+1) vs Class {1, 2} (-1)
============================================================
H2 Training samples: 576
  Positive (+1): 533 samples
  Negative (-1): 43 samples
  Accuracy mode: both

Set parameter TimeLimit to value 1800
Set parameter MIPGap to value 0.0001
Set parameter OutputFlag to value 1
Set parameter Threads to value 0
Gurobi Optimizer version 13.0.1 build v13.0.1rc0 (linux64 - "Ubuntu 24.04.3 LTS")

CPU model: AMD Ryzen 9 9900X 12-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 20 physical cores, 20 logical processors, using up to 20 threads

Non-default parameters:
TimeLimit  1800

Optimize a model with 4076 rows, 2370 columns and 16498 nonzeros (Min)
Model fingerprint: 0x76a8270c
Model has 1772 linear objective coefficients
Variable types: 621 continuous, 1749 integer (1749 binary)
Coefficient statistics:
  Matrix range     [1e-07, 1e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+03]

Found heuristic solution: objective 85.0000000
Presolve removed 29 rows and 30 columns
Presolve time: 0.01s
Presolved: 4047 rows, 2340 columns, 16874 nonzeros
Variable types: 36 continuous, 2304 integer (1728 binary)

Root relaxation: objective -1.740000e+00, 835 iterations, 0.01 seconds (0.05 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   -1.74000    0  129   85.00000   -1.74000   102%     -    0s
     0     0   -0.73701    0  134   85.00000   -0.73701   101%     -    0s
     0     0    7.24595    0  129   85.00000    7.24595  91.5%     -    0s
     0     0    8.24096    0  144   85.00000    8.24096  90.3%     -    0s
     0     0    8.24295    0  145   85.00000    8.24295  90.3%     -    0s
     0     0   15.21938    0  150   85.00000   15.21938  82.1%     -    0s
     0     0   21.21940    0  157   85.00000   21.21940  75.0%     -    0s
     0     0   22.21537    0  156   85.00000   22.21537  73.9%     -    0s
     0     0   24.06132    0  366   85.00000   24.06132  71.7%     -    0s
     0     0   24.20365    0  164   85.00000   24.20365  71.5%     -    0s
     0     0   24.20555    0  163   85.00000   24.20555  71.5%     -    0s
     0     0   30.20159    0  258   85.00000   30.20159  64.5%     -    0s
     0     0   30.20326    0  267   85.00000   30.20326  64.5%     -    0s
     0     0   33.91506    0  381   85.00000   33.91506  60.1%     -    0s
     0     0   34.25227    0  282   85.00000   34.25227  59.7%     -    0s
     0     0   34.68588    0  371   85.00000   34.68588  59.2%     -    0s
     0     0   34.97099    0  376   85.00000   34.97099  58.9%     -    0s
     0     0   35.15125    0  328   85.00000   35.15125  58.6%     -    0s
     0     0   35.18664    0  353   85.00000   35.18664  58.6%     -    0s
     0     0   35.18861    0  363   85.00000   35.18861  58.6%     -    0s
     0     0   38.45853    0  377   85.00000   38.45853  54.8%     -    0s
     0     0   40.42951    0  294   85.00000   40.42951  52.4%     -    0s
     0     0   40.75192    0  381   85.00000   40.75192  52.1%     -    0s
     0     0   40.76060    0  390   85.00000   40.76060  52.0%     -    0s
     0     0   40.81608    0  380   85.00000   40.81608  52.0%     -    0s
     0     0   40.82652    0  382   85.00000   40.82652  52.0%     -    0s
     0     0   40.82709    0  385   85.00000   40.82709  52.0%     -    0s
     0     0   41.37914    0  280   85.00000   41.37914  51.3%     -    0s
     0     0   43.89799    0  383   85.00000   43.89799  48.4%     -    0s
     0     0   43.99289    0  387   85.00000   43.99289  48.2%     -    0s
     0     0   44.02749    0  395   85.00000   44.02749  48.2%     -    0s
     0     0   44.06312    0  389   85.00000   44.06312  48.2%     -    0s
     0     0   44.07005    0  391   85.00000   44.07005  48.2%     -    0s
     0     0   47.69311    0  341   85.00000   47.69311  43.9%     -    0s
     0     0   48.37620    0  378   85.00000   48.37620  43.1%     -    0s
     0     0   48.63577    0  373   85.00000   48.63577  42.8%     -    0s
     0     0   48.85447    0  377   85.00000   48.85447  42.5%     -    0s
     0     0   48.88195    0  370   85.00000   48.88195  42.5%     -    0s
     0     0   48.94683    0  365   85.00000   48.94683  42.4%     -    0s
     0     0   48.96485    0  372   85.00000   48.96485  42.4%     -    0s
     0     0   48.97784    0  376   85.00000   48.97784  42.4%     -    0s
     0     0   48.97784    0  376   85.00000   48.97784  42.4%     -    0s
     0     0   50.75724    0  334   85.00000   50.75724  40.3%     -    0s
     0     0   51.55097    0  377   85.00000   51.55097  39.4%     -    0s
     0     0   52.13357    0  364   85.00000   52.13357  38.7%     -    0s
     0     0   52.35882    0  370   85.00000   52.35882  38.4%     -    0s
     0     0   52.41065    0  359   85.00000   52.41065  38.3%     -    0s
     0     0   52.42455    0  363   85.00000   52.42455  38.3%     -    0s
     0     0   52.42987    0  361   85.00000   52.42987  38.3%     -    0s
     0     0   52.84631    0  340   85.00000   52.84631  37.8%     -    0s
     0     0   53.21535    0  357   85.00000   53.21535  37.4%     -    0s
     0     0   53.25575    0  359   85.00000   53.25575  37.3%     -    0s
     0     0   53.30401    0  350   85.00000   53.30401  37.3%     -    0s
     0     0   53.36037    0  359   85.00000   53.36037  37.2%     -    0s
     0     0   53.36101    0  354   85.00000   53.36101  37.2%     -    0s
     0     0   53.38237    0  366   85.00000   53.38237  37.2%     -    0s
     0     0   53.50451    0  351   85.00000   53.50451  37.1%     -    0s
     0     0   53.53153    0  358   85.00000   53.53153  37.0%     -    0s
     0     0   53.53874    0  357   85.00000   53.53874  37.0%     -    0s
     0     0   53.92949    0  323   85.00000   53.92949  36.6%     -    0s
     0     0   54.09876    0  342   85.00000   54.09876  36.4%     -    0s
     0     0   54.18197    0  354   85.00000   54.18197  36.3%     -    0s
     0     0   54.20316    0  352   85.00000   54.20316  36.2%     -    0s
     0     0   54.22093    0  356   85.00000   54.22093  36.2%     -    0s
     0     0   54.22111    0  356   85.00000   54.22111  36.2%     -    0s
     0     0   54.27822    0  360   85.00000   54.27822  36.1%     -    0s
     0     0   54.36153    0  350   85.00000   54.36153  36.0%     -    0s
     0     0   54.37686    0  356   85.00000   54.37686  36.0%     -    0s
     0     0   54.37895    0  358   85.00000   54.37895  36.0%     -    0s
     0     0   63.28747    0  339   85.00000   63.28747  25.5%     -    0s
     0     0   65.39436    0  347   85.00000   65.39436  23.1%     -    0s
     0     0   65.80697    0  341   85.00000   65.80697  22.6%     -    0s
     0     0   65.93990    0  321   85.00000   65.93990  22.4%     -    0s
     0     0   65.99693    0  324   85.00000   65.99693  22.4%     -    0s
     0     0   66.00130    0  331   85.00000   66.00130  22.4%     -    0s
     0     0   66.04527    0  321   85.00000   66.04527  22.3%     -    0s
     0     0   66.95735    0  334   85.00000   66.95735  21.2%     -    0s
     0     0   67.00342    0  343   85.00000   67.00342  21.2%     -    0s
     0     0   67.00670    0  334   85.00000   67.00670  21.2%     -    0s
     0     0   67.23593    0  351   85.00000   67.23593  20.9%     -    0s
     0     0   67.46580    0  341   85.00000   67.46580  20.6%     -    0s
     0     0   67.54004    0  347   85.00000   67.54004  20.5%     -    0s
     0     0   67.54512    0  348   85.00000   67.54512  20.5%     -    0s
     0     0   67.59666    0  352   85.00000   67.59666  20.5%     -    0s
     0     0   67.59788    0  343   85.00000   67.59788  20.5%     -    0s
     0     0   67.68113    0  340   85.00000   67.68113  20.4%     -    0s
     0     0   67.71191    0  335   85.00000   67.71191  20.3%     -    0s
     0     0   67.71205    0  341   85.00000   67.71205  20.3%     -    0s
     0     0   68.88591    0  296   85.00000   68.88591  19.0%     -    0s
     0     0   69.14784    0  307   85.00000   69.14784  18.6%     -    0s
     0     0   69.20891    0  318   85.00000   69.20891  18.6%     -    0s
     0     0   69.22860    0  341   85.00000   69.22860  18.6%     -    0s
     0     0   69.23321    0  324   85.00000   69.23321  18.5%     -    0s
     0     0   69.33249    0  339   85.00000   69.33249  18.4%     -    0s
     0     0   69.35472    0  333   85.00000   69.35472  18.4%     -    0s
     0     0   69.95291    0  313   85.00000   69.95291  17.7%     -    0s
     0     0   70.34085    0  322   85.00000   70.34085  17.2%     -    0s
     0     0   70.59224    0  316   85.00000   70.59224  17.0%     -    0s
     0     0   70.88382    0  343   85.00000   70.88382  16.6%     -    0s
     0     0   70.93658    0  337   85.00000   70.93658  16.5%     -    0s
     0     0   70.94839    0  322   85.00000   70.94839  16.5%     -    0s
     0     0   71.12839    0  333   85.00000   71.12839  16.3%     -    0s
     0     0   71.17522    0  313   85.00000   71.17522  16.3%     -    0s
     0     0   71.19393    0  326   85.00000   71.19393  16.2%     -    0s
     0     0   71.20277    0  330   85.00000   71.20277  16.2%     -    0s
     0     0   71.20612    0  333   85.00000   71.20612  16.2%     -    0s
     0     0   71.21943    0  343   85.00000   71.21943  16.2%     -    0s
     0     0   72.38486    0  327   85.00000   72.38486  14.8%     -    0s
     0     0   72.38876    0  343   85.00000   72.38876  14.8%     -    0s
     0     0   72.63166    0  320   85.00000   72.63166  14.6%     -    0s
     0     0   72.73778    0  316   85.00000   72.73778  14.4%     -    0s
     0     0   72.84511    0  315   85.00000   72.84511  14.3%     -    1s
     0     0   72.85711    0  319   85.00000   72.85711  14.3%     -    1s
     0     0   73.03337    0  303   85.00000   73.03337  14.1%     -    1s
     0     0   73.04502    0  295   85.00000   73.04502  14.1%     -    1s
     0     0   73.07428    0  300   85.00000   73.07428  14.0%     -    1s
     0     0   73.08305    0  300   85.00000   73.08305  14.0%     -    1s
     0     0   73.08305    0  299   85.00000   73.08305  14.0%     -    1s
     0     2   73.08305    0  299   85.00000   73.08305  14.0%     -    1s
  8395  1151   84.73392   19   70   85.00000   81.66259  3.93%   133    5s

Cutting planes:
  Gomory: 78
  Cover: 3
  Implied bound: 228
  Dual implied bound: 14
  MIR: 363
  Flow cover: 590
  Inf proof: 8
  Relax-and-lift: 12

Explored 12528 nodes (1611898 simplex iterations) in 6.44 seconds (17.38 work units)
Thread count was 20 (of 20 available processors)

Solution count 2: 85 85 

Optimal solution found (tolerance 1.00e-04)
Best objective 8.500000000000e+01, best bound 8.500000000000e+01, gap 0.0000%

H2 Solution:
  Weights (w): [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
  Intercept (b): 1.0
  Objective: 85.000000
  Selected features: 21/21
  L1 norm: 0.000000
  Positive accuracy lb: 1.0000
  Negative accuracy lb: 0.0000

============================================================
Training Complete!
============================================================

Training completed in: 0:00:07.011812

================================================================================
Model Summary
================================================================================
Status: fitted
Strategy: test2
Features: 21

Class Roles:
  Majority: Class 3
  Medium:   Class 2
  Minority: Class 1

Classifier 1 (H1): Class {2, 3} vs Class 1
  Objective: 27.000000
  Selected Features: 21/21
  L1 Norm: 0.000000

Classifier 2 (H2): Class 3 vs Class {1, 2}
  Objective: 85.000000
  Selected Features: 21/21
  L1 Norm: 0.000000

================================================================================
H1 Complete Weights and Bias
================================================================================
Description: Class {2, 3} vs Class 1

Intercept (b): 1.0000000000

Weight vector (w) - 21 features:
  w[0] = 0.0000000000
  w[1] = 0.0000000000
  w[2] = 0.0000000000
  w[3] = 0.0000000000
  w[4] = 0.0000000000
  w[5] = 0.0000000000
  w[6] = 0.0000000000
  w[7] = 0.0000000000
  w[8] = 0.0000000000
  w[9] = 0.0000000000
  w[10] = 0.0000000000
  w[11] = 0.0000000000
  w[12] = 0.0000000000
  w[13] = 0.0000000000
  w[14] = 0.0000000000
  w[15] = 0.0000000000
  w[16] = 0.0000000000
  w[17] = 0.0000000000
  w[18] = 0.0000000000
  w[19] = 0.0000000000
  w[20] = 0.0000000000

L1 Norm: 0.0000000000

================================================================================
H2 Complete Weights and Bias
================================================================================
Description: Class 3 vs Class {1, 2}

Intercept (b): 1.0000000000

Weight vector (w) - 21 features:
  w[0] = 0.0000000000
  w[1] = 0.0000000000
  w[2] = 0.0000000000
  w[3] = 0.0000000000
  w[4] = 0.0000000000
  w[5] = 0.0000000000
  w[6] = 0.0000000000
  w[7] = 0.0000000000
  w[8] = 0.0000000000
  w[9] = 0.0000000000
  w[10] = 0.0000000000
  w[11] = 0.0000000000
  w[12] = 0.0000000000
  w[13] = 0.0000000000
  w[14] = 0.0000000000
  w[15] = 0.0000000000
  w[16] = 0.0000000000
  w[17] = 0.0000000000
  w[18] = 0.0000000000
  w[19] = 0.0000000000
  w[20] = 0.0000000000

L1 Norm: 0.0000000000

================================================================================
Training Set Evaluation
================================================================================


============================================================
Evaluation Results
============================================================

Total Accuracy: 0.9253

Per-Class Accuracy:
  Class 1: 0.0000
  Class 2: 0.0000
  Class 3: 1.0000

Class Distribution:
  Class 1: 14 samples
  Class 2: 29 samples
  Class 3: 533 samples

Confusion Matrix:
     Pred 1  Pred 2  Pred 3
True 1:     0       0      14
True 2:     0       0      29
True 3:     0       0     533
============================================================

================================================================================
Test Set Evaluation
================================================================================


============================================================
Evaluation Results
============================================================

Total Accuracy: 0.9236

Per-Class Accuracy:
  Class 1: 0.0000
  Class 2: 0.0000
  Class 3: 1.0000

Class Distribution:
  Class 1: 3 samples
  Class 2: 8 samples
  Class 3: 133 samples

Confusion Matrix:
     Pred 1  Pred 2  Pred 3
True 1:     0       0       3
True 2:     0       0       8
True 3:     0       0     133
============================================================

================================================================================
Test Complete!
================================================================================
Training Duration: 0:00:07.011812
Training Accuracy: 0.9253
Test Accuracy: 0.9236
Log saved to: /home/bs10081/Developer/hcesvm/results/test2_Thyroid_20260210_193728.log
================================================================================
