================================================================================
Hierarchical CE-SVM - Inverted Strategy
Dataset: New_Thyroid
Timestamp: 2026-01-31 17:41:47
================================================================================

Loading training data from: /home/bs10081/Developer/NSVORA/Archive/new-thyroid_split.xlsx

  Note: Excluding non-numeric columns: ['Class']
Loaded multi-class data:
  Class 1: 120 samples
  Class 2: 28 samples
  Class 3: 24 samples
  Features: 5
Training data loaded:
  Class 1: 120 samples
  Class 2: 28 samples
  Class 3: 24 samples
  Features: 5

================================================================================
Model Parameters
================================================================================
  C_hyper: 1.0
  epsilon: 0.0001
  M: 1000.0
  time_limit: 1800
  mip_gap: 0.0001
  threads: 0
  verbose: True
  enable_selection: True
  feat_upper_bound: 1000
  feat_lower_bound: 1e-07

================================================================================
Training Hierarchical Classifier - Inverted Strategy
================================================================================

Inverted Strategy:
  H1: medium class vs {majority, minority}
  H2: {medium, majority} vs minority
  (Class roles determined dynamically based on sample counts)

============================================================
Training Hierarchical CE-SVM (Strategy: inverted)
============================================================
Class 1: 120 samples
Class 2: 28 samples
Class 3: 24 samples
Features: 5

Dynamic Class Roles:
  Majority:  Class 1 (120 samples)
  Medium:    Class 2 (28 samples)
  Minority:  Class 3 (24 samples)

============================================================
Training H1: Class 2 (+1) vs {Class 1, 3} (-1)
============================================================
H1 Training samples: 172
  Positive (+1): 28 samples
  Negative (-1): 144 samples

Set parameter Username
Set parameter LicenseID to value 2749150
Academic license - for non-commercial use only - expires 2026-12-03
Set parameter TimeLimit to value 1800
Set parameter MIPGap to value 0.0001
Set parameter OutputFlag to value 1
Set parameter Threads to value 0
Gurobi Optimizer version 13.0.1 build v13.0.1rc0 (linux64 - "Ubuntu 24.04.3 LTS")

CPU model: AMD Ryzen 9 9900X 12-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 20 physical cores, 20 logical processors, using up to 20 threads

Non-default parameters:
TimeLimit  1800

Optimize a model with 1216 rows, 706 columns and 4324 nonzeros (Min)
Model fingerprint: 0x4f79f0de
Model has 528 linear objective coefficients
Variable types: 185 continuous, 521 integer (521 binary)
Coefficient statistics:
  Matrix range     [1e-07, 1e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 3e+02]

Found heuristic solution: objective 105.8083859
Presolve removed 7 rows and 7 columns
Presolve time: 0.00s
Presolved: 1209 rows, 699 columns, 4464 nonzeros
Found heuristic solution: objective 99.1009354
Variable types: 11 continuous, 688 integer (516 binary)
Found heuristic solution: objective 92.1009354

Root relaxation: objective -1.858000e+00, 380 iterations, 0.00 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   -1.85800    0   84   92.10094   -1.85800   102%     -    0s
H    0     0                      55.0000000   -1.85800   103%     -    0s
H    0     0                       9.8732189   -1.85800   119%     -    0s
H    0     0                       7.4416739   -1.85800   125%     -    0s
H    0     0                       6.9436741   -1.85800   127%     -    0s
H    0     0                       6.0200639   -1.12639   119%     -    0s
     0     0   -1.12639    0   57    6.02006   -1.12639   119%     -    0s
H    0     0                       5.7946332   -1.12463   119%     -    0s
H    0     0                       5.6676539   -1.12463   120%     -    0s
H    0     0                       4.8549961   -1.12463   123%     -    0s
H    0     0                       4.6676539   -1.12463   124%     -    0s
H    0     0                       3.8549961   -1.12463   129%     -    0s
     0     0   -0.77139    0   57    3.85500   -0.77139   120%     -    0s
     0     0    0.17292    0   40    3.85500    0.17292  95.5%     -    0s
     0     0    0.25453    0   43    3.85500    0.25453  93.4%     -    0s
     0     0    0.28985    0   45    3.85500    0.28985  92.5%     -    0s
     0     0    0.28989    0   46    3.85500    0.28989  92.5%     -    0s
     0     0    0.47642    0   49    3.85500    0.47642  87.6%     -    0s
     0     0    0.49406    0   58    3.85500    0.49406  87.2%     -    0s
     0     0    0.50266    0   42    3.85500    0.50266  87.0%     -    0s
     0     0    0.50910    0   43    3.85500    0.50910  86.8%     -    0s
     0     0    0.51198    0   43    3.85500    0.51198  86.7%     -    0s
     0     0    0.51207    0   43    3.85500    0.51207  86.7%     -    0s
     0     0    0.65462    0   54    3.85500    0.65462  83.0%     -    0s
     0     0    0.66669    0   48    3.85500    0.66669  82.7%     -    0s
     0     0    0.66957    0   34    3.85500    0.66957  82.6%     -    0s
     0     0    0.67073    0   37    3.85500    0.67073  82.6%     -    0s
     0     0    0.68389    0   34    3.85500    0.68389  82.3%     -    0s
     0     0    0.70164    0   38    3.85500    0.70164  81.8%     -    0s
     0     0    0.84527    0   34    3.85500    0.84527  78.1%     -    0s
     0     0    1.03232    0   34    3.85500    1.03232  73.2%     -    0s
     0     0    1.03232    0   34    3.85500    1.03232  73.2%     -    0s
     0     2    1.09052    0   34    3.85500    1.09052  71.7%     -    0s
*  156     0              10       3.0919961    2.84880  7.87%  19.0    0s

Cutting planes:
  Gomory: 2
  Implied bound: 11
  MIR: 13
  Flow cover: 12
  RLT: 1

Explored 173 nodes (3850 simplex iterations) in 0.13 seconds (0.20 work units)
Thread count was 20 (of 20 available processors)

Solution count 10: 3.092 3.855 4.66765 ... 9.87322

Optimal solution found (tolerance 1.00e-04)
Best objective 3.091996071614e+00, best bound 3.091996071614e+00, gap 0.0000%

H1 Solution:
  Objective: 3.091996
  Selected features: 5/5
  L1 norm: 3.085052
  Positive accuracy lb: 1.0000
  Negative accuracy lb: 0.9931

============================================================
Training H2: Class {Class 2, 1} (+1) vs Class 3 (-1)
============================================================
H2 Training samples: 172
  Positive (+1): 148 samples
  Negative (-1): 24 samples

Set parameter TimeLimit to value 1800
Set parameter MIPGap to value 0.0001
Set parameter OutputFlag to value 1
Set parameter Threads to value 0
Gurobi Optimizer version 13.0.1 build v13.0.1rc0 (linux64 - "Ubuntu 24.04.3 LTS")

CPU model: AMD Ryzen 9 9900X 12-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 20 physical cores, 20 logical processors, using up to 20 threads

Non-default parameters:
TimeLimit  1800

Optimize a model with 1216 rows, 706 columns and 4324 nonzeros (Min)
Model fingerprint: 0xeb5da271
Model has 528 linear objective coefficients
Variable types: 185 continuous, 521 integer (521 binary)
Coefficient statistics:
  Matrix range     [1e-07, 1e+03]
  Objective range  [1e+00, 1e+00]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 3e+02]

Found heuristic solution: objective 336.7244925
Presolve removed 7 rows and 7 columns
Presolve time: 0.00s
Presolved: 1209 rows, 699 columns, 4464 nonzeros
Variable types: 11 continuous, 688 integer (516 binary)
Found heuristic solution: objective 329.7244925

Root relaxation: objective -1.878560e+00, 506 iterations, 0.00 seconds (0.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0   -1.87856    0  179  329.72449   -1.87856   101%     -    0s
H    0     0                      46.7696390   -1.87856   104%     -    0s
H    0     0                       3.7105287   -1.87856   151%     -    0s
H    0     0                       3.0101597   -1.87856   162%     -    0s
     0     0   -1.28906    0   76    3.01016   -1.28906   143%     -    0s
     0     0    0.29258    0  182    3.01016    0.29258  90.3%     -    0s
     0     0    0.52950    0  106    3.01016    0.52950  82.4%     -    0s
     0     0    0.52950    0   92    3.01016    0.52950  82.4%     -    0s
     0     0    0.52950    0   45    3.01016    0.52950  82.4%     -    0s
     0     0    0.52950    0   45    3.01016    0.52950  82.4%     -    0s
     0     0    0.71262    0   27    3.01016    0.71262  76.3%     -    0s
     0     0    1.62978    0   37    3.01016    1.62978  45.9%     -    0s
     0     0    2.83614    0   58    3.01016    2.83614  5.78%     -    0s
     0     0    3.01016    0   55    3.01016    3.01016  0.00%     -    0s

Cutting planes:
  Lift-and-project: 4
  Implied bound: 26
  MIR: 13
  Flow cover: 16
  RLT: 3

Explored 1 nodes (1087 simplex iterations) in 0.12 seconds (0.19 work units)
Thread count was 20 (of 20 available processors)

Solution count 5: 3.01016 3.71053 46.7696 ... 336.724

Optimal solution found (tolerance 1.00e-04)
Best objective 3.010159651669e+00, best bound 3.010159309397e+00, gap 0.0000%

H2 Solution:
  Objective: 3.010160
  Selected features: 5/5
  L1 norm: 4.010160
  Positive accuracy lb: 1.0000
  Negative accuracy lb: 1.0000

============================================================
Training Complete!
============================================================

Training completed in: 0:00:00.278216

================================================================================
Model Summary
================================================================================
Status: fitted
Strategy: inverted
Features: 5

Class Roles:
  Majority: Class 1
  Medium:   Class 2
  Minority: Class 3

Classifier 1 (H1): Class 2 vs {Class 1, 3}
  Objective: 3.091996
  Selected Features: 5/5
  L1 Norm: 3.085052

Classifier 2 (H2): Class {Class 2, 1} vs Class 3
  Objective: 3.010160
  Selected Features: 5/5
  L1 Norm: 4.010160

================================================================================
Training Set Evaluation
================================================================================


============================================================
Evaluation Results
============================================================

Total Accuracy: 0.9884

Per-Class Accuracy:
  Class 1: 0.9917
  Class 2: 1.0000
  Class 3: 0.9583

Class Distribution:
  Class 1: 120 samples
  Class 2: 28 samples
  Class 3: 24 samples

Confusion Matrix:
     Pred 1  Pred 2  Pred 3
True 1:   119       1       0
True 2:     0      28       0
True 3:     1       0      23
============================================================

================================================================================
Test Set Evaluation
================================================================================

Loading test data (skiprows=4)...
  Note: Excluding non-numeric columns: ['Class']
Loaded multi-class data:
  Class 1: 30 samples
  Class 2: 7 samples
  Class 3: 6 samples
  Features: 5
Test data loaded:
  Class 1: 30 samples
  Class 2: 7 samples
  Class 3: 6 samples


============================================================
Evaluation Results
============================================================

Total Accuracy: 0.9767

Per-Class Accuracy:
  Class 1: 0.9667
  Class 2: 1.0000
  Class 3: 1.0000

Class Distribution:
  Class 1: 30 samples
  Class 2: 7 samples
  Class 3: 6 samples

Confusion Matrix:
     Pred 1  Pred 2  Pred 3
True 1:    29       1       0
True 2:     0       7       0
True 3:     0       0       6
============================================================

================================================================================
Test Complete!
================================================================================
Training Duration: 0:00:00.278216
Training Accuracy: 0.9884
Test Accuracy: 0.9767
Log saved to: /home/bs10081/Developer/hcesvm/results/inverted_New_Thyroid_20260131_174147.log
================================================================================
